{"id":2518797,"slug":"dayzbe","title":"回归原理","book_id":187563,"book":{"id":187563,"type":"Book","slug":"uirecorder","name":"UIRecorder","user_id":296279,"description":"一端录制，多端使用的便捷 UI 自动化测试工具","creator_id":94302,"public":1,"items_count":22,"likes_count":0,"watches_count":12,"content_updated_at":"2019-10-11T06:31:45.205Z","updated_at":"2019-10-11T06:31:45.000Z","created_at":"2018-12-11T06:11:00.000Z","namespace":"artist/uirecorder","user":{"id":296279,"type":"Group","login":"artist","name":"F&D艺术家-前端自动化测试","description":"探索与推广前端自动化测试","avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png","large_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":4,"public_books_count":4,"followers_count":0,"following_count":0,"created_at":"2019-03-21T06:44:55.000Z","updated_at":"2019-08-08T02:30:37.000Z","_serializer":"v2.user"},"_serializer":"v2.book"},"user_id":94302,"creator":{"id":94302,"type":"User","login":"linshuoting","name":"说听(Stngle)","description":"F&D艺术家   \nhttps://github.com/Stngle","avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png","large_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":2,"public_books_count":1,"followers_count":8,"following_count":6,"created_at":"2018-03-21T12:59:06.000Z","updated_at":"2019-10-09T08:37:02.000Z","_serializer":"v2.user"},"format":"lake","body":"","body_draft":"","body_html":"<!doctype html><div class=\"lake-content-editor-core lake-engine\" data-lake-element=\"root\" data-selection-94302=\"%7B%22path%22%3A%5B%5B20%2C2%2C1%2C0%2C52%5D%2C%5B20%2C2%2C1%2C0%2C52%5D%5D%2C%22uuid%22%3A%2294302%22%2C%22active%22%3Atrue%7D\"><h2 id=\"qD93O\" style=\"padding: 7px 0px; margin: 0px; font-weight: 700; font-size: 24px; line-height: 32px;\">一、原理流程图</h2><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><span data-card-type=\"inline\" data-lake-card=\"image\"><img data-role=\"image\" src=\"https://cdn.nlark.com/yuque/0/2019/png/94302/1570636308812-82161291-6289-4add-b91a-c1dc947a3b3e.png?x-oss-process=image/resize,w_1500\" data-raw-src=\"https://cdn.nlark.com/yuque/0/2019/png/94302/1570636308812-82161291-6289-4add-b91a-c1dc947a3b3e.png\" class=\"image lake-drag-image\" alt=\"image.png\" title=\"image.png\" style=\"visibility: visible; width: 746px; height: 431px;\"></span></p><p style=\"text-align: center; font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><u><em>原理流程图</em></u></p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">&nbsp; &nbsp; &nbsp; &nbsp; 测试脚本采用 BDD 的风格定义了测试用例，通过 Runner 执行（浏览器操作通过调用 WebDriver Service 实现），返回对应的回归测试结果（object），测试结果经过 Reporter 进行渲染，生成测试报告。</p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><h3 id=\"Jmnqu\" style=\"padding: 7px 0px; margin: 0px; font-weight: 700; font-size: 20px; line-height: 28px;\">1.1 Runner</h3><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">&nbsp; &nbsp; &nbsp; &nbsp; Runner 包括 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">mocha</code>&nbsp;、 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">macaca-mocha-parallel-tests</code>&nbsp;（fork <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">mocha-parallel-tests</code>&nbsp;优化的版本），其中跑单个测试用例使用 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">mocha</code>&nbsp;，并行跑多个测试用例则使用 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">macaca-mocha-parallel-tests</code>&nbsp;。Runner 的作用可以简单概括为以下三点：Pre-Loader（预加载功能）、Runner（执行器）、Reporter（报告器）。</p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><ul lake-indent=\"0\" style=\"list-style-type: disc; margin: 0px; padding-left: 23px; font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word;\"><li><strong>Pre-Loader（预加载功能）</strong>：通过 describe/it 函数定义一组或单个的测试用例，通过 loader 处理，可转化成一个树状结构的 object</li><li><strong>Runner（执行器）</strong>：object 可以通过 Runner 执行回归测试，输出测试结果（也是一个树状 object）</li><li><strong>Reporter（报告器）</strong>：利用测试结果，生成简单格式的测试报告输出</li></ul><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><h3 id=\"o5tnM\" style=\"padding: 7px 0px; margin: 0px; font-weight: 700; font-size: 20px; line-height: 28px;\">1.2 Reporter</h3><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">&nbsp; &nbsp; &nbsp; &nbsp; Mocha 自带的 Reporter 展示形式比较单一，难以满足我们的测试场景需求。UIRecorder 自主维护的两款报告器是 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">macaca-reporter</code>&nbsp;、 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">mochawesome-uirecorder</code>&nbsp;，uirecorder@3.0 版本以后统一使用 <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">macaca-reporter</code>&nbsp;， <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">mochawesome-uirecorder</code>&nbsp;已废弃。其中， <code style=\"font-family: monospace; font-size: inherit; background-color: rgba(0, 0, 0, 0.06); padding: 0px 2px; border: 1px solid rgba(0, 0, 0, 0.08); border-radius: 2px; line-height: inherit; overflow-wrap: break-word; text-indent: 0px;\">macaca-reporter</code>&nbsp;的作用主要是利用 Runner 执行后返回的结果（object），自定义渲染模版，从链路树模式、脑图模式、全图模式和列表模式多维度直观呈现运行结果。</p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><h3 id=\"i6dxJ\" style=\"padding: 7px 0px; margin: 0px; font-weight: 700; font-size: 20px; line-height: 28px;\">1.3 WebDriver Service</h3><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span>WebDriver 利用浏览器原生的API，封装了一层 WebDriver API，通过 http 协议可以直接操作浏览器页面的DOM节点元素，甚至操作浏览器本身（截屏，窗口大小，启动，关闭，安装插件，配置证书等）。且 Selenium 已得到各大主流浏览器厂商支持，可利用 WebDriver 服务进行多浏览器兼容性测试。</span></p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><h2 id=\"gWVOF\" style=\"padding: 7px 0px; margin: 0px; font-weight: 700; font-size: 24px; line-height: 32px;\">二、更多参考</h2><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\"><br></p><blockquote style=\"padding-left: 1em; margin-top: 5px; margin-bottom: 5px; margin-left: 0px; border-left: 3px solid rgb(238, 238, 238); opacity: 0.6;\"><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">如何实现一个简易版的 Mocha：<a href=\"https://www.yuque.com/artist/aori6e/vt4171\" target=\"_blank\">https://www.yuque.com/artist/aori6e/vt4171</a></p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">macaca-mocha-parallel-tests：<a href=\"https://github.com/macacajs/macaca-mocha-parallel-tests\" target=\"_blank\">https://github.com/macacajs/macaca-mocha-parallel-tests</a></p><p style=\"font-size: 14px; color: rgb(38, 38, 38); line-height: 24px; letter-spacing: 0.05em; outline-style: none; overflow-wrap: break-word; margin: 0px;\">F2etest WebDriver：<a href=\"https://www.yuque.com/artist/f2etest/webdriver-cloud\" target=\"_blank\">https://www.yuque.com/artist/f2etest/webdriver-cloud</a></p></blockquote></div>","body_lake":"<!doctype lake><meta name=\"doc-version\" content=\"1\" /><h2 id=\"qD93O\">一、原理流程图</h2><p><br /></p><p><card type=\"inline\" name=\"image\" value=\"data:%7B%22src%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2019%2Fpng%2F94302%2F1570636308812-82161291-6289-4add-b91a-c1dc947a3b3e.png%22%2C%22originWidth%22%3A2324%2C%22originHeight%22%3A1344%2C%22name%22%3A%22image.png%22%2C%22size%22%3A371079%2C%22display%22%3A%22inline%22%2C%22align%22%3A%22left%22%2C%22linkTarget%22%3A%22_blank%22%2C%22status%22%3A%22done%22%2C%22search%22%3A%22%22%2C%22width%22%3A774.6666666666666%2C%22height%22%3A448%7D\"></card></p><p style=\"text-align: center;\"><u><em>原理流程图</em></u></p><p><br /></p><p>        测试脚本采用 BDD 的风格定义了测试用例，通过 Runner 执行（浏览器操作通过调用 WebDriver Service 实现），返回对应的回归测试结果（object），测试结果经过 Reporter 进行渲染，生成测试报告。</p><p><br /></p><h3 id=\"Jmnqu\">1.1 Runner</h3><p>        Runner 包括 <code>mocha</code> 、 <code>macaca-mocha-parallel-tests</code> （fork <code>mocha-parallel-tests</code> 优化的版本），其中跑单个测试用例使用 <code>mocha</code> ，并行跑多个测试用例则使用 <code>macaca-mocha-parallel-tests</code> 。Runner 的作用可以简单概括为以下三点：Pre-Loader（预加载功能）、Runner（执行器）、Reporter（报告器）。</p><p><br /></p><ul><li><strong>Pre-Loader（预加载功能）</strong>：通过 describe/it 函数定义一组或单个的测试用例，通过 loader 处理，可转化成一个树状结构的 object</li><li><strong>Runner（执行器）</strong>：object 可以通过 Runner 执行回归测试，输出测试结果（也是一个树状 object）</li><li><strong>Reporter（报告器）</strong>：利用测试结果，生成简单格式的测试报告输出</li></ul><p><br /></p><h3 id=\"o5tnM\">1.2 Reporter</h3><p>        Mocha 自带的 Reporter 展示形式比较单一，难以满足我们的测试场景需求。UIRecorder 自主维护的两款报告器是 <code>macaca-reporter</code> 、 <code>mochawesome-uirecorder</code> ，uirecorder@3.0 版本以后统一使用 <code>macaca-reporter</code> ， <code>mochawesome-uirecorder</code> 已废弃。其中， <code>macaca-reporter</code> 的作用主要是利用 Runner 执行后返回的结果（object），自定义渲染模版，从链路树模式、脑图模式、全图模式和列表模式多维度直观呈现运行结果。</p><p><br /></p><h3 id=\"i6dxJ\">1.3 WebDriver Service</h3><p>        <span>WebDriver 利用浏览器原生的API，封装了一层 WebDriver API，通过 http 协议可以直接操作浏览器页面的DOM节点元素，甚至操作浏览器本身（截屏，窗口大小，启动，关闭，安装插件，配置证书等）。且 Selenium 已得到各大主流浏览器厂商支持，可利用 WebDriver 服务进行多浏览器兼容性测试。</span></p><p><br /></p><h2 id=\"gWVOF\">二、更多参考</h2><p><br /></p><blockquote style=\"padding-left: 1em;\"><p>如何实现一个简易版的 Mocha：<a href=\"https://www.yuque.com/artist/aori6e/vt4171\" target=\"_blank\">https://www.yuque.com/artist/aori6e/vt4171</a></p><p>macaca-mocha-parallel-tests：<a href=\"https://github.com/macacajs/macaca-mocha-parallel-tests\" target=\"_blank\">https://github.com/macacajs/macaca-mocha-parallel-tests</a></p><p>F2etest WebDriver：<a href=\"https://www.yuque.com/artist/f2etest/webdriver-cloud\" target=\"_blank\">https://www.yuque.com/artist/f2etest/webdriver-cloud</a></p></blockquote>","public":1,"status":null,"likes_count":2,"comments_count":0,"content_updated_at":"2019-10-11T03:22:18.000Z","deleted_at":null,"created_at":"2019-09-02T02:11:02.000Z","updated_at":"2019-10-11T05:43:25.000Z","published_at":"2019-10-11T03:22:18.000Z","first_published_at":"2019-10-11T03:22:18.000Z","word_count":545,"cover":null,"description":"一、原理流程图原理流程图        测试脚本采用 BDD 的风格定义了测试用例，通过 Runner 执行（浏览器操作通过调用 WebDriver Service 实现），返回对应的回归测试结果（object），测试结果经过 Reporter 进行渲染，生成测试报告。1.1 Runner  ...","custom_description":null,"_serializer":"v2.doc_detail"}